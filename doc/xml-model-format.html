<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<title>MDiG XML model format</title></head><body><h1>MDiG XML model format</h1>MDiG is designed to model the spread of invasive species. Here the&nbsp;<a href="http://en.wikipedia.org/wiki/XML">XML format</a> for specifying models is described.<br>All the below tags are encolsed in the tags &lt;model&gt; &lt;/model&gt;. Tags in italics are optional.<br><h2>User</h2><pre style="font-style: italic;">&lt;user&gt;&lt;email&gt;joel@fruitionnz.com&lt;/email&gt;&lt;/user&gt;</pre>This
section allows an email to be specified which the system should attempt
to email once the simulation is finished. This primarily for the
potential case of MDiG&nbsp;used via&nbsp;a web-based interface,&nbsp;
allowing jobs to be submitted with MDiG&nbsp;emailing the user on
completion of the simulation with a URL to the results (requesting a
login with necessary).<br><h2>Name</h2><pre>&lt;name&gt; lhumile &lt;/name&gt;</pre>A simple&nbsp;alphanumeric name for use in filenames, and for&nbsp;referring to the species.<br><h2>Description</h2><pre style="font-style: italic;">&lt;description&gt; Argentine Ant &lt;/description&gt;</pre>Further
description of the model and/or organism. Primarily for users to
explain their model when they pass it on to other researchers or
archive it.<br><h2>Random</h2><pre>&lt;random&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&lt;initialSeed&gt; 1 &lt;/initialSeed&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&lt;replicates&gt; 1 &lt;/replicates&gt;</pre><pre>&nbsp;&nbsp; &nbsp;<span style="font-style: italic;">&lt;offset&gt;0&lt;/offset&gt;</span></pre><pre>&lt;/random&gt;</pre>Sets up the random number generator and number of simulation replicates, <span style="font-weight: bold;">initialSeed</span> indicates the seed to be used for the first replicate. <span style="font-weight: bold;">replicates</span> is the number of times to repeat each permutation of parameters. <span style="font-weight: bold;">offset</span>
indicates the state of the random number generator when MDiG last
finished running simulations on the model (in the case that not all
simulations were finished last time MDiG was run using this model
definition file, allowing it to resume where it left off).<br><h2>Regions</h2>Indicates a list of regions to carry out simulations on. Each region entry has the format:<br><pre>&lt;region id="a" name="test"&gt;</pre><pre>&nbsp;&nbsp; &nbsp;<span style="font-style: italic;">&lt;resolution&gt;150&lt;/resolution&gt;</span></pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;extents north="6609068" south="6354012" west="2568074" east="2829814"/&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;background&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;map&gt;aa_background&lt;/map&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;/background&gt;</pre><pre>&lt;/region&gt;</pre>The&nbsp;<span style="font-style: italic;">id</span> tag of the <span style="font-weight: bold;">region</span> is used for completed simulations to refer to, the&nbsp;<span style="font-style: italic;">name</span>
parameter loads an predefined existing region with the given name. In
GRASS this is equivalent to the command "g.region region=test". Any sub
elements will override the parameters of this loaded region however.<br><span style="font-weight: bold;">Resolution</span> indicates the raster resolution for simulation. <span style="font-weight: bold;">Extents</span> indicates the boundaries of the simulation region.<br><span style="font-weight: bold;">Background</span> specifies what should be displayed first when updating the map display. This is a "map type"<br><h3>A brief diversion into what a map type is</h3>Map types are nodes of the XML tree that&nbsp;can have the following values:<br><ul><li>A <span style="font-weight: bold;">&lt;map&gt;</span>
sub element is the name of a map in the current location using with
optional mapset (using @ GRASS format). Example: nz_dem@simulation
refers to the nz_dem map in the simulation mapset.</li><li>A <span style="font-weight: bold;">&lt;value&gt;</span> sub element indicates a constant value across the current region.</li><li>A <span style="font-weight: bold;">&lt;mapcalc&gt; </span>sub
element specifies a Map Algebra expression. This can have an optional
attribute "refresh" which means the map should be regenerated everytime
it is accessed. This is in the case of random elements or dependencies
on changing maps. The format of the expression is the same format that
the GRASS command r.mapcalc accepts.</li></ul><h2>Period</h2><pre>&lt;period&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&lt;startTime&gt; 1990 &lt;/startTime&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&lt;endTime&gt; 2006 &lt;/endTime&gt;</pre><pre>&nbsp;&nbsp; &nbsp;<span style="font-style: italic;">&lt;step&gt; 1 &lt;/step&gt; </span></pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;timeUnit&gt; Year &lt;/timeUnit&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;numberOfTimeIntervals&gt; 365 &lt;/numberOfTimeIntervals&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;numberOfTimeIntervalUnit&gt; Day &lt;/numberOfTimeIntervalUnit&gt;</pre><pre>&lt;/period&gt;</pre>Indicates the start and end time of the simulation. Optionally, it also specifies, the length of each discrete time step (<span style="font-weight: bold;">&lt;step&gt;</span>). The units of time that simulation is dealing with (&lt;<span style="font-weight: bold;">timeUnit&gt;</span>). How the <span style="font-weight: bold;">timeUnit</span> should be divided for timing of lifestages.<br><br>The total range&nbsp;for phenology events to occur in is [1 .. (<span style="font-weight: bold;">&lt;numberOfTimeIntervals&gt;</span> * <span style="font-weight: bold;">&lt;step&gt;</span>)]<br><br>The default values for <span style="font-weight: bold;">&lt;step&gt;</span>, <span style="font-weight: bold;">&lt;timeUnit&gt;</span>, <span style="font-weight: bold;">&lt;numberOfTimeIntervals&gt;</span> and <span style="font-weight: bold;">&lt;timeIntervalUnit&gt;</span> are shown.<br><h2>Output</h2><pre>&lt;output&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;raster&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;interval&gt;1&lt;/interval&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;lifestage&gt;all&lt;/lifestage&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;/raster&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;png&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;interval&gt;1&lt;/interval&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;showTime&gt;true&lt;/showTime&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;showGrid size="500"&gt;false&lt;/showGrid&gt;</pre><pre style="font-style: italic;">&nbsp;&nbsp; &nbsp;&lt;/png&gt;</pre><pre>&lt;/output&gt;</pre>Output indicates what direct output (the population distribution maps) of the simulation/model should be saved. <span style="font-weight: bold;">&lt;raster&gt;</span>
allows for the raster maps that are generated to be permanently saved -
and are then referenced in the completed instances of the simulation
(for later access in analysis). <span style="font-weight: bold;">&lt;interval&gt;</span>
indicates how many maps should be skipped (1= indicates none). Note
that if the time step for the simulation is &gt; 1 then the interval is
NOT the difference between successive time values, but the number of
steps. <span style="font-weight: bold;">&lt;lifestage&gt;</span> indicates the id of the lifestage to save the distribution of.<br><br><span style="font-weight: bold;">&lt;png&gt;</span> allows for graphics to be output while the simulation is being performed. This has the same format as <span style="font-weight: bold;">&lt;raster&gt;</span>, but can also overlay a grid <span style="font-weight: bold;">&lt;showGrid&gt;</span> with resolution&nbsp;<span style="font-style: italic;">size</span>, and display the simulation time <span style="font-weight: bold;">&lt;showTime&gt;</span>.<br><br><h2>Lifestages</h2>Lifestages contains all the lifestage elements within the tags:<br><pre>&lt;lifestages&gt; ... &lt;/lifestages&gt;</pre><h3>Lifestage</h3>Each lifestage is specified by &lt;lifestage name="all" populationBased="false"&gt;. The <span style="font-style: italic;">name</span> is for referral in maps, <span style="font-style: italic;">populationBased</span>
indicates whether this lifestage is based on presence and absences or
population density. Each lifestage&nbsp;has the following sub-elements:<br><h4>&lt;initialDistribution&gt;</h4>This tag indicates the the initial distribution for the current lifestage. It has a parameter&nbsp;<span style="font-style: italic;">region</span> that expects a region ID to indicate what region the initial distribution is for.<br>It can contain either&nbsp;a map type or a coordinates list such as, e.g:<br><pre>&nbsp;&nbsp; &nbsp;&lt;sites&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;s x="2671900" y="6474300"/&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;s x="2671900" y="6474400"/&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;s x="2672400" y="6474500"/&gt;</pre><pre>&nbsp;&nbsp; &nbsp;&lt;/sites&gt;</pre>Coordinates are read in as vector points, and then converted to a raster. <span style="font-style: italic;">count</span> is an optional parameter to the sites <span style="font-weight: bold;">&lt;s&gt;</span> tags, for use when the lifestage is population based.<br><h4>&lt;phenology&gt;</h4>Indicates when the lifestage occurs. Needs a region ID in the&nbsp;<span style="font-style: italic;">region</span> parameter. It expects a map type as a sub element. The values of which indicate when in the range [1 .. <span style="font-weight: bold;">&lt;step&gt;*&lt;numberOfIntervals&gt;</span> ] the lifestage should occur.<br><h4>A number of &lt;event&gt; elements</h4><pre>&lt;event name="r.dispersal.neighbour"&gt;</pre><pre>	&lt;param name="shape"&gt;</pre><pre>		&lt;value&gt;186&lt;/value&gt; </pre><pre>	&lt;/param&gt;</pre><pre>	&lt;param name="radius"&gt;</pre><pre>		&lt;variable id="var1"&gt;<br>			&lt;value&gt;3000&lt;/value&gt;<br>			&lt;value&gt;2000&lt;/value&gt;<br>		&lt;/variable&gt;<br></pre><pre>	&lt;/param&gt;</pre><pre>	&lt;ifNotPopulationBased&gt;</pre><pre>		&lt;flag name="b"/&gt;</pre><pre>	&lt;/ifNotPopulationBased&gt;</pre><pre>&lt;/event&gt;</pre>Each of these <span style="font-weight: bold;">&lt;event&gt;</span> elements define a spread or population process. The <span style="font-style: italic;">name</span> parameter indicates the&nbsp;GRASS command that carries out the process. What then follows are a number of <span style="font-weight: bold;">param</span> elements which are command line arguments to&nbsp;<span style="font-style: italic;">name</span>. Each <span style="font-weight: bold;">param</span> can have a <span style="font-weight: bold;">value</span> element, or a <span style="font-weight: bold;">variable</span> element which has indicates a number of <span style="font-weight: bold;">value</span>s
to simulate over. Every permutation of these values (mixed with all
other variables) is&nbsp;an "instance", and each "instance" is run for
the number of replicates defined above in the <span style="font-weight: bold;">random</span> tag.<br><br>Conditional tags can also be added for population vs presence-absence models (<span style="font-weight: bold;">ifNotPopulationBased</span>). But one would better off using separate files at this stage...<br><br>Another option for events, is the <span style="font-weight: bold;">flag</span> tag which are parameters to the commands that don't expect arguments.<br><br>Additionally,
these event commands also receive an input= option and an output=
option that process the map specified by input and return a map with
the name specified by output.<br><br>For example, the above event corresponds to the two commands:<br><br>r.dispersal.neighbour input=a output=b shape=186 radius=3000 -b<br>r.dispersal.neighbour input=a output=b shape=186 radius=2000 -b<br><h4>Analyses</h4><pre>&lt;analyses&gt;</pre><pre>	&lt;analysis name="r.stats"&gt;</pre><pre>		&lt;param name="input"&gt;</pre><pre>			&lt;previousMap/&gt;</pre><pre>		&lt;/param&gt;</pre><pre>		&lt;flag name="c"/&gt;</pre><pre>		&lt;flag name="n"/&gt;</pre><pre>		&lt;output&gt;</pre><pre>			&lt;file generate="true" ext=".dat" append="true" date="true"/&gt;</pre><pre>		&lt;/output&gt;</pre><pre>	&lt;/analysis&gt;</pre><pre>&lt;/analyses&gt;</pre><pre></pre>Analyses
can also be specified within the model, as well as being run later.
Their format is similar to that of events, but&nbsp;also indicate an <span style="font-weight: bold;">output</span> tag that tells MDiG what to do with the output of the analysis. Sub nodes of <span style="font-weight: bold;">param</span> elements can also be <span style="font-weight: bold;">currentMap</span>, <span style="font-weight: bold;">previousMap</span>, and <span style="font-weight: bold;">initialMap</span> instead of <span style="font-weight: bold;">value</span>
so that what that what the analysis examines can be specified (some
analysis requires more than a single map - such trying to calculate the
distance from initial points of a invasion to the current distribution).<br><br>The <span style="font-weight: bold;">output</span> tag is has a sub node <span style="font-weight: bold;">file</span>, the optional text of which is the filename, and this has the parameters:<br><ul><li>generate - if true, it generates a filename, the text of the <span style="font-weight: bold;">file</span> tag is used as a prefix is it exists.</li><li>append - if true will append onto the end of the file (default: false)</li><li>ext - specify the extension of the file created.</li><li>date - append the interval/timestep to the file created before appending the output of the analysis command.</li></ul><h2>Instances</h2>The
format also specifies how MDiG stores the results. Saving the names of
each map, the associated timestep and instance, the associated analysis
results, and the occupancy envelopes if they have been created.<br></body></html>
